(()=>{"use strict";var t,e={531:(t,e,s)=>{s(260);class i extends Phaser.Scene{constructor(t){super(t)}fade(t,e,s){let i=Phaser.Display.Color.ColorToRGBA(s);this.cameras.main.fadeEffect.start(t,e,i.r,i.g,i.b)}flash(t,e=16777215){let s=Phaser.Display.Color.ColorToRGBA(e);this.cameras.main.flashEffect.start(t,s.r,s.g,s.b)}addEvent(t,e,s=this){return this.time.addEvent({delay:t,callback:e,callbackScope:s})}createText(t=0,e=0,s=20,i="#FFF",r=""){return this.add.text(t,e,r,{fontFamily:"Hammersmith One",fontSize:Math.max(s,1)+"px",color:i}).setLineSpacing(.4*s)}fitToScreen(t){t.setScale(Math.max(this.W/t.width,this.H/t.height))}containToScreen(t){t.setScale(Math.min(this.W/t.width,this.H/t.height))}get W(){return this.cameras.main.displayWidth}get H(){return this.cameras.main.displayHeight}get CX(){return this.cameras.main.centerX}get CY(){return this.cameras.main.centerY}}class r extends Phaser.Renderer.WebGL.Pipelines.PostFXPipeline{constructor(t){super({game:t,name:"GrayScalePostFilter"})}onPreRender(){this.colorMatrix.blackWhite()}onDraw(t){this.drawFrame(t,this.fullFrame1),this.bindAndDraw(this.fullFrame1)}}class a extends Phaser.Renderer.WebGL.Pipelines.PostFXPipeline{constructor(t){super({game:t,name:"BlurPostFilter",fragShader:"\n\t\t\t\t#ifdef GL_FRAGMENT_PRECISION_HIGH\n\t\t\t\t#define highmedp highp\n\t\t\t\t#else\n\t\t\t\t#define highmedp mediump\n\t\t\t\t#endif\n\t\t\t\tprecision highmedp float;\n\n\t\t\t\tuniform sampler2D uMainSampler;\n\t\t\t\tvarying vec2 outTexCoord;\n\t\t\t\tuniform vec2 uTexSize;\n\t\t\t\tuniform vec2 uOffset;\n\n\t\t\t\tvoid main (void) {\n\t\t\t\t\tvec4 c = texture2D( uMainSampler, outTexCoord );\n\t\t\t\t\tvec4 l = texture2D( uMainSampler, outTexCoord + uOffset );\n\t\t\t\t\tvec4 r = texture2D( uMainSampler, outTexCoord - uOffset );\n\n\t\t\t\t\tgl_FragColor = (1.0*c + 1.0*l + 1.0*r) / 3.0;\n\t\t\t\t}\n\t\t\t"}),this.offsetX=1,this.offsetY=1,this.lowres=!0,this.steps=8}onPreRender(){this.set2f("uTexSize",this.game.scale.width,this.game.scale.height)}onDraw(t){const e=this.lowres?this.halfFrame1:this.fullFrame1,s=this.lowres?this.halfFrame2:this.fullFrame2;this.copyFrame(t,e);const i=1/e.width*this.offsetX,r=1/e.height*this.offsetY;for(let t=0;t<this.steps;t++)this.set2f("uOffset",i,0),this.bindAndDraw(e,s),this.set2f("uOffset",0,r),this.bindAndDraw(s,e);this.bindAndDraw(e)}}function h(t,e){for(let s of e)s.path=t+s.path;return e}let o=t=>({key:t,path:t+".png"}),n=t=>({key:t+".png",path:t+".png"});const d=h("assets/images/",[o("halfdoorlock"),o("halfdooropen"),o("bridge"),o("spikes"),o("pointer"),o("text_bg")]),l=h("assets/tilemaps/",[n("roof"),n("floor"),n("wall")]),p=h("assets/spritesheets/",[{key:"mouse",path:"mouse.png",width:256,height:200},{key:"cat",path:"cat.png",width:256,height:256},{key:"monster",path:"monster.png",width:256,height:256},{key:"thought",path:"thought.png",width:512,height:256},{key:"flower",path:"flower.png",width:256,height:256}]),g=h("assets/audio/",[{key:"Amb_Dungeon",path:"Amb_Dungeon.mp3",volume:.06},{key:"Amb_DripAmogus",path:"Amb_DripAmogus.mp3",volume:.12},{key:"Amb_Music",path:"Amb_Music.mp3",volume:.06},{key:"Char_Step_01",path:"Char_Step_01.mp3",volume:.08},{key:"Char_Step_02",path:"Char_Step_02.mp3",volume:.08},{key:"Char_Step_03",path:"Char_Step_03.mp3",volume:.08},{key:"Char_Step_04",path:"Char_Step_04.mp3",volume:.08},{key:"Nar_Static",path:"Nar_Static.mp3",volume:.1},{key:"UI_PickUp",path:"UI_PickUp.mp3",volume:.4},{key:"UI_PutDown",path:"UI_PutDown.mp3",volume:.4},{key:"UI_BoxAppear",path:"UI_BoxAppear.mp3",volume:.2},{key:"V_01",path:"V_01.mp3",volume:.5},{key:"V_02_End",path:"V_02_End.mp3",volume:.5},{key:"V_02_Start",path:"V_02_Start.mp3",volume:.5},{key:"V_03",path:"V_03.mp3",volume:.5},{key:"V_04_End",path:"V_04_End.mp3",volume:.5},{key:"V_04_Start",path:"V_04_Start.mp3",volume:.5},{key:"V_Not",path:"V_Not.mp3",volume:.5}]);class c{constructor(t,e,s){this.scene=t,this.sounds=new Map;for(let t of g)this.addSound(t.key,t.volume)}addSound(t,e){let s=this.scene.sound.add(t,{volume:e});this.sounds.set(t,s)}play(t,e){let s=this.sounds.get(t);s&&(e?s.play(e):s.play())}}class u extends Phaser.GameObjects.Container{constructor(t,e,s){super(t,0,0),this.scene=t,this.scene.add.existing(this),this.sprite=t.physics.add.sprite(e,s,"cat",0),this.sprite.setScale(.5),this.add(this.sprite);let i=.7*this.sprite.displayWidth;this.sprite.body.setCircle(i,i/2,.8*i),this.setupAnimations(),this.walkSpeed=400,this.prevFrame="2",this.mood="idle",this.thoughtBubble=this.scene.add.sprite(this.scene.CX,this.scene.CY-40,"thought",0),this.thoughtBubble.setScrollFactor(0,0),this.thoughtBubble.setOrigin(.5,1),this.thoughtBubble.setScale(.5),this.thoughtBubble.setVisible(!0),this.thoughtBubble.play("thinking",!0),this.thoughtBubble.setDepth(6),this.scene.add.existing(this.thoughtBubble)}update(t,e){let s=this.scene.getInputDirection();if(0==s.x&&0==s.y||this.isAsleep)"angry"==this.mood?this.play("angry",!0):"sleeping"==this.mood?this.play("sleeping",!0):"scared"==this.mood?this.play("scared",!0):this.play("idle",!0);else{if(this.play("walk",!0),"2"==this.sprite.frame.name&&this.prevFrame!=this.sprite.frame.name){let t=["Char_Step_01","Char_Step_02","Char_Step_03","Char_Step_04"][Math.floor(4*Math.random())];this.scene.audio.play(t)}this.prevFrame=this.sprite.frame.name,0!=s.x&&(this.sprite.scaleX=.5*(s.x>0?1:-1))}this.isAsleep||(this.sprite.body.setVelocityX(this.walkSpeed*s.x),this.sprite.body.setVelocityY(this.walkSpeed*s.y))}play(t,e=!1){this.sprite.play(t,e)}setupAnimations(){this.scene.anims.create({key:"idle",frames:[{key:"cat",frame:0,duration:300},{key:"cat",frame:1,duration:300}],repeat:-1}),this.scene.anims.create({key:"walk",frames:[{key:"cat",frame:3,duration:100},{key:"cat",frame:2,duration:100}],repeat:-1}),this.scene.anims.create({key:"angry",frames:[{key:"cat",frame:4,duration:300},{key:"cat",frame:5,duration:300}],repeat:-1}),this.scene.anims.create({key:"sleeping",frames:[{key:"cat",frame:6,duration:300},{key:"cat",frame:7,duration:300}],repeat:-1}),this.scene.anims.create({key:"thinking",frames:[{key:"thought",frame:0,duration:300},{key:"thought",frame:1,duration:300}],repeat:-1})}get isAsleep(){return"sleeping"==this.mood}}class m extends Phaser.GameObjects.Container{constructor(t,e,s){super(t,e,s),this.scene=t,this.scene.add.existing(this),this.sprite=t.physics.add.sprite(0,0,"monster",0),this.sprite.setScale(.5),this.sprite.setTint(12037575),this.sprite.body.immovable=!0;let i=1.8*this.sprite.displayWidth;this.sprite.body.setSize(i,i),this.add(this.sprite),this.mood="idle",this.setupAnimations()}update(t,e){"dead"==this.mood?this.play("monster_dead",!0):"angry"==this.mood?this.play("monster_angry",!0):"sleeping"==this.mood?this.play("monster_sleeping",!0):"scared"==this.mood?this.play("monster_scared",!0):this.play("monster_idle",!0),this.sprite.body.enable=!["dead","sleeping","scared"].includes(this.mood)}play(t,e=!1){this.sprite.play(t,e)}setupAnimations(){this.scene.anims.create({key:"monster_idle",frames:[{key:"monster",frame:0,duration:300},{key:"monster",frame:1,duration:300}],repeat:-1}),this.scene.anims.create({key:"monster_sleeping",frames:[{key:"monster",frame:2,duration:300},{key:"monster",frame:3,duration:300}],repeat:-1}),this.scene.anims.create({key:"monster_angry",frames:[{key:"monster",frame:4,duration:300},{key:"monster",frame:5,duration:300}],repeat:-1}),this.scene.anims.create({key:"monster_scared",frames:[{key:"monster",frame:6,duration:300},{key:"monster",frame:7,duration:300}],repeat:-1}),this.scene.anims.create({key:"monster_dead",frames:[{key:"monster",frame:8,duration:0}],repeat:-1})}}class y extends Phaser.GameObjects.Image{constructor(t,e,s,i,r){super(t,e,s,i,r),t.add.existing(this),this.setScale(.5),this.setFrame(r),this.setTint(11193599)}}let f={player:{text:"<empty>",audio:void 0,draggable:!0,empty:!0},sleep_1:{text:"Deep in a dungeon, there is"},sleep_not:{text:"<empty>",draggable:!0,empty:!0,trigger:"dead",type:"not"},sleep_2:{text:"a cat"},sleep_whois:{text:"who is asleep",draggable:!0,trigger:"sleeping",type:"who is"},story_after_sleep:{text:"Yet through sheer will, it changed the story"},guard_1:{text:"A mean monster"},guard_whois:{text:"<empty>",draggable:!0,empty:!0,type:"who is"},guard_2:{text:"is guarding the room"},angry_1:{text:"The"},angry_mood1:{text:"<empty>",draggable:!0,empty:!0,type:"mood"},angry_2:{text:"cat meets another"},angry_mood2:{text:"angry",draggable:!0,type:"mood",trigger:"angry"},angry_3:{text:"monster"},scared_1:{text:"The guarding monster"},scared_whois:{text:"<empty>",draggable:!0,empty:!0,type:"who is"},scared_2:{text:"is scared of angry cats"},flower_1:{text:"Nothing here aside from a small flower"},flower_ending:{text:"but sadly it is lifeless",draggable:!0,type:"ending",trigger:"dead"},murder_1:{text:"Another mean monster blocks your path"},murder_ending:{text:"<empty>",draggable:!0,empty:!0,type:"ending"},pesky_1:{text:"The pesky cat thought it was being clever by"},pesky_escape:{text:"putting words in my mouth",draggable:!0,type:"escape"},clever_1:{text:"Thanks for playing!"}},w={sleep:{hitarea:{x:0,y:0,w:300,h:300},phrases:["sleep_1","sleep_not","sleep_2","sleep_whois"]},story_after_sleep:{hitarea:{x:768,y:0,w:200,h:300},phrases:["story_after_sleep"]},guard:{hitarea:{x:1344,y:-128,w:200,h:200},phrases:["guard_1","guard_whois","guard_2"]},angry:{hitarea:{x:640,y:-1152,w:300,h:300},phrases:["angry_1","angry_mood1","angry_2","angry_mood2","angry_3"]},scared:{hitarea:{x:1792,y:-1088,w:200,h:300},phrases:["scared_1","scared_whois","scared_2"]},flower:{hitarea:{x:2944,y:-2112,w:300,h:300},phrases:["flower_1","flower_ending"]},murder:{hitarea:{x:3456,y:-1536,w:200,h:300},phrases:["murder_1","murder_ending"]},pesky:{hitarea:{x:4352,y:-1536,w:200,h:3e3},phrases:["pesky_1","pesky_escape"]},clever:{hitarea:{x:4992,y:-1536,w:400,h:3e3},phrases:["clever_1"]}};for(let t in w)w[t].phrases=w[t].phrases.map((t=>f[t]));class _ extends Phaser.GameObjects.Text{constructor(t,e){super(t,0,0,"",e),this.scene=t,this.setOrigin(0,.5),this.setVisible(!1),this.setScrollFactor(0,0)}update(t,e){this.phrase&&this.phrase.draggable&&(this.phrase.empty?(this.setStroke("#FFAA00",4),e?this.setText("_____"):this.setText("")):(this.setStroke("#FF7700",4),this.setText(this.phrase.text))),this.input.hitArea.setTo(-30,-30,this.width+60,this.height+60)}onDropzone(){this.setStroke("#00FF00",4)}getPhrase(){return this.phrase}setPhrase(t){this.phrase=t,this.setText(this.phrase.text),this.input&&(this.input.enabled=this.phrase.draggable),this.setEmpty(t.empty)}setEmpty(t){this.phrase.empty=t}get draggable(){return this.phrase.draggable}get empty(){return this.phrase.empty}}class x extends Phaser.GameObjects.Text{constructor(t,e){super(t,0,0,"",e),this.scene=t,this.setOrigin(0,.5),this.setVisible(!1),this.setScrollFactor(0,0),this.setStroke("#FF0000",4),this.lock=!1,this.goalX=0,this.goalY=0,this.dragX=0,this.dragY=0,this.dragOffsetX=0,this.dragOffsetY=0,this.drag=!1}update(){this.drag&&(this.x+=(this.goalX-this.x)/2,this.y+=(this.goalY-this.y)/2)}}class k extends Phaser.GameObjects.Container{constructor(t,e,s){super(t,0,0),this.cX=e,this.cY=s,this.scene=t,this.scene.add.existing(this),this.fontConfig={fontFamily:"Hammersmith One",fontSize:"28px",color:"#FFF"},this.bg=this.scene.add.image(this.cX,this.cY,"text_bg"),this.bg.setScrollFactor(0,0),this.add(this.bg),this.words=[];for(let t=0;t<10;t++){let t=this.createWord();this.add(t),this.words.push(t)}this.thoughtWord=this.createWord(),this.thoughtWord.setPhrase(f.player),this.thoughtWord.setVisible(!0),this.thoughtWord.setScale(.7),this.thoughtWord.setDepth(100),this.scene.add.existing(this.thoughtWord),this.thoughtAlpha=0,this.dragWord=new x(this.scene,this.fontConfig),this.makeDraggable(),this.dragWord.setDepth(100),this.scene.add.existing(this.dragWord)}update(t,e){let s;this.thoughtWord.empty&&!this.dragWord.drag||(s=this.thoughtWord.phrase.type),this.checkPointerOver(),this.dropzone=void 0,this.words.forEach((t=>{if(t.phrase){let e=s==t.phrase.type;this.selected&&this.dragWord.drag&&t.phrase.type==this.selected.phrase.type&&(e=!0),t.update(this.dragWord.drag,e),this.checkOverlap(t)}})),this.thoughtWord.update(this.dragWord.drag,!0),this.checkOverlap(this.thoughtWord),this.dragWord.update(),this.repositionText(),this.thoughtWord.x=this.scene.CX-this.thoughtWord.displayWidth/2,this.thoughtWord.y=this.scene.CY-117;let i=!this.thoughtWord.empty||this.dragWord.drag;i&&this.thoughtAlpha<1&&(this.thoughtAlpha+=.1),!i&&this.thoughtAlpha>0&&(this.thoughtAlpha-=.1),this.thoughtWord.setAlpha(this.thoughtAlpha),this.scene.player.thoughtBubble.setAlpha(this.thoughtAlpha)}createWord(){let t=new _(this.scene,this.fontConfig);return this.makeSelectable(t),t}resetText(){this.words.forEach((t=>{t.setVisible(!1)}))}setPhrases(t){this.resetText();for(let e=0;e<t.length;e++)this.words[e].setPhrase(t[e]),this.words[e].setVisible(!0);this.repositionText()}repositionText(){let t=0;for(let e of this.words)e.visible&&(e.setPosition(this.cX+t,this.cY),""!=e.text&&(t+=e.width+6));t-=6;for(let e of this.words)e.x-=t/2;this.selected&&!this.dragWord.drag&&(this.dragWord.x=this.selected.x,this.dragWord.y=this.selected.y),this.bg.scaleX=(80+t)/this.bg.width}checkPointerOver(){let t=!1;for(let e of this.words)e.input.enabled&&Phaser.Geom.Rectangle.Contains(e.input.hitArea,this.scene.input.x-e.x,this.scene.input.y-e.y+e.displayHeight/2)&&(this.pointerOver(e),t=!0);this.thoughtWord.input.enabled&&Phaser.Geom.Rectangle.Contains(this.thoughtWord.input.hitArea,this.scene.input.x-this.thoughtWord.x,this.scene.input.y-this.thoughtWord.y+this.thoughtWord.displayHeight/2)&&(this.pointerOver(this.thoughtWord),t=!0),t||this.dragWord.drag||this.onDragEnd()}pointerOver(t){!t.getPhrase()||this.selected||t.empty||(this.dragWord.x=t.x,this.dragWord.y=t.y,this.dragWord.setScale(t.scaleX),this.dragWord.setText(t.phrase.text),this.dragWord.setVisible(!0),this.selected=t)}makeSelectable(t){t.setInteractive({useHandCursor:!0,draggable:!0}),t.on("dragstart",((t,e,s)=>{this.dragWord.lock=!0,this.dragWord.dragOffsetX=this.x,this.dragWord.dragOffsetY=this.y,this.dragWord.dragX=t.x,this.dragWord.dragY=t.y})),t.on("drag",((t,e,s)=>{this.dragWord.lock&&(Math.abs(t.x-this.dragWord.dragX)>20||Math.abs(t.y-this.dragWord.dragY)>20)&&this.onDragStart(),this.dragWord.goalX=e+this.dragWord.dragOffsetX,this.dragWord.goalY=s+this.dragWord.dragOffsetY})),t.on("dragend",(()=>{this.onDragEnd()}))}checkOverlap(t){t.getPhrase()&&(t.setEmpty(t.empty),t.draggable&&t.empty&&this.dragWord.drag&&this.selected&&Phaser.Geom.Rectangle.Contains(t.input.hitArea,this.scene.input.x-t.x,this.scene.input.y-t.y+t.displayHeight/2)&&(this.dropzone=t,t.onDropzone()))}makeDraggable(){}onDragStart(){this.dragWord.drag=!0,this.dragWord.lock=!1,this.selected&&(this.selected.setVisible(!0),this.selected.setEmpty(!0),this.repositionText()),this.scene.audio.play("UI_PickUp")}onDragEnd(){this.dragWord.setVisible(!1),this.dragWord.drag=!1,this.selected&&(this.dropzone?(this.swapPhrases(this.selected.phrase,this.dropzone.phrase),this.dropzone==this.thoughtWord&&(this.selected.phrase.type=this.dropzone.phrase.type),this.dropzone.setEmpty(!1),this.scene.audio.play("UI_PutDown")):(this.selected.setVisible(!0),this.selected.setEmpty(!1)),this.selected=void 0,this.repositionText())}swapPhrases(t,e){for(let s of["text","audio","draggable","empty","trigger","type"]){let i=t[s];t[s]=e[s],e[s]=i}}}class b extends Phaser.GameObjects.Container{constructor(t,e,s){super(t,e,s),this.scene=t,this.scene.add.existing(this),this.world=t.make.tilemap({key:"map",tileWidth:32,tileHeight:32}),this.loadProps();let i=[];for(let t of this.world.tilesets){let e=this.world.addTilesetImage(t.name,t.name);i.push(e)}let r=this.properties.Scale;this.groundLayer=this.world.createLayer("Ground",i),this.groundLayer.setPosition(this.groundLayer.x*r,this.groundLayer.y*r),this.groundLayer.setScale(r),this.wallLayer=this.world.createLayer("Foreground",i),this.wallLayer.setPosition(this.wallLayer.x*r,this.wallLayer.y*r),this.wallLayer.setScale(r),this.world.setCollisionBetween(0,100,!0,!0,this.wallLayer),this.wallLayer.setCollisionBetween(0,100,!0)}loadProps(){this.properties={};for(let t in this.world.properties){let e=this.world.properties[t];this.properties[e.name]=e.value}}wallInPlayer(t){this.wallLayer.setCollisionByExclusion([-1]),this.scene.physics.collide(t.sprite,this.wallLayer,(()=>{console.log("hello?")}))}}var W=s(227);const v={type:Phaser.WEBGL,width:960,height:540,scale:{mode:Phaser.Scale.FIT},physics:{default:"arcade",arcade:{gravity:{y:0}}},scene:[class extends i{constructor(){super({key:"PreloadScene"})}init(){let t=this.renderer;t.pipelines.addPostPipeline("GrayScalePostFilter",r),t.pipelines.addPostPipeline("BlurPostFilter",a)}preload(){let t=.5*this.W,e=this.CX-t/2,s=this.CY,i=(this.add.rectangle(e,s,t,4,6710886).setOrigin(0,.5),this.add.rectangle(e,s,1,8,14540253).setOrigin(0,.5));this.createText(e,s,3*i.height,"#DDD","Loading...").setOrigin(0,1.5),this.load.on("progress",(e=>{i.width=e*t}));for(let t of d)this.load.image(t.key,t.path);for(let t of p)this.load.spritesheet(t.key,t.path,{frameWidth:t.width,frameHeight:t.height});for(let t of g)this.load.audio(t.key,[t.path]);this.load.tilemapTiledJSON("map","assets/tilemaps/level1.json");for(let t of l)this.load.image(t.key,t.path)}create(){let t=.5*this.W,e=this.CX+t/2,s=this.CY;this.tapToStart=this.createText(e,s,24,"#FFD","Tap to start!").setOrigin(1,-.5),this.input.on("pointerdown",this.start.bind(this))}update(t){this.tapToStart.setAlpha(.8+.2*Math.sin(t/100))}start(){this.fade(!0,800,0),this.addEvent(1e3,(()=>{this.scene.start("GameScene")}))}},class extends i{constructor(){super({key:"GameScene"})}create(){this.cameras.main.setBackgroundColor(0),this.fade(!1,3e3,0),this.world=new b(this,0,0),this.player=new u(this,w.sleep.hitarea.x,w.sleep.hitarea.y-40),this.player.setDepth(5),this.physics.world.enable(this.player.sprite),this.cameras.main.startFollow(this.player.sprite),this.physics.add.collider(this.player.sprite,this.world.wallLayer),this.monsters={guard:new m(this,w.guard.hitarea.x,w.guard.hitarea.y-280),angry:new m(this,w.angry.hitarea.x-130,w.angry.hitarea.y-20),scared:new m(this,w.scared.hitarea.x+300,w.scared.hitarea.y+30),murder:new m(this,w.murder.hitarea.x+300,w.murder.hitarea.y)};for(let t in this.monsters)this.physics.add.collider(this.player.sprite,this.monsters[t].sprite);this.flowers={lifeless:new y(this,w.flower.hitarea.x+20,w.flower.hitarea.y-100,"flower",0),dead1:new y(this,w.angry.hitarea.x+70,w.angry.hitarea.y-230,"flower",1),dead2:new y(this,w.angry.hitarea.x-150,w.angry.hitarea.y-260,"flower",1)},this.darkness=this.add.rectangle(this.CX,this.CY,this.W,this.H,0),this.darkness.setScrollFactor(0,0),this.narrator=new k(this,this.CX,.85*this.H),this.narrator.setScrollFactor(0,0),this.narrator.setDepth(10),this.audio=new c(this,this.CX,.85*this.H),this.audio.play("Amb_Dungeon",{loop:!0}),this.audio.play("Amb_DripAmogus",{loop:!0}),this.pointer=this.add.image(this.CX,this.CY,"pointer"),this.pointer.setDepth(1e3),this.pointer.setScale(.4),this.pointer.setOrigin(.3),this.pointer.setAlpha(0),this.curve=new Phaser.Curves.CubicBezier(new Phaser.Math.Vector2(40,-150),new Phaser.Math.Vector2(300,-100),new Phaser.Math.Vector2(350,50),new Phaser.Math.Vector2(250,150)),this.storyMode="intro",this.zoneTimer=-3,this.createAreaTriggers(),this.world.wallInPlayer(this.player),this.setupInput()}update(t,e){let s=e/1e3;if(this.player.update(t,s),this.narrator.update(t,s),this.checkTriggers(),this.narrator.setAlpha(this.zoneTimer),this.narrator.bg.setAlpha(this.zoneTimer),"intro"==this.storyMode){this.zoneTimer+=s;let e=1-t/3%1e3/1e3;e=Phaser.Math.Easing.Cubic.InOut(e);let i=this.curve.getPoint(e);this.pointer.x=i.x,this.pointer.y=i.y,this.pointer.setAlpha(this.zoneTimer/2-3),this.player.isAsleep||(this.storyMode="game",this.pointer.setVisible(!1),this.audio.play("Amb_Music",{loop:!0}))}else"game"==this.storyMode&&(this.darkness.setAlpha(this.darkness.alpha-.02),this.zoneTimer-=.05,this.zoneTimer<=0&&(this.currentZone=void 0,this.narrator.onDragEnd()));for(let e in this.monsters)this.monsters[e].update(t,s);this.mouseInput.reset();const i=this.input.activePointer;i.isDown&&!this.narrator.dragWord.visible&&this.mouseInput.set(i.x-this.CX,i.y-this.CY)}checkTriggers(){this.player.mood=f.sleep_whois.trigger||f.angry_mood1.trigger||"idle",this.monsters.guard.mood=f.guard_whois.trigger||"angry",this.monsters.scared.mood=f.scared_whois.trigger||"idle","angry"==this.player.mood&&"sleeping"!=this.monsters.scared.mood&&(this.monsters.scared.mood="scared"),this.monsters.angry.mood=f.angry_mood2.trigger||"idle",this.monsters.murder.mood=f.murder_ending.trigger||"idle",this.flowers.lifeless.setFrame("dead"==f.flower_ending.trigger?1:0)}createAreaTriggers(){this.zones=[];for(let t in w){let e=w[t],s=this.add.zone(e.hitarea.x,e.hitarea.y,e.hitarea.w,e.hitarea.h);this.zones.push(s),this.physics.world.enable(s),this.physics.add.overlap(this.player.sprite,s,(()=>{"game"==this.storyMode&&(this.zoneTimer=2),this.currentZone!=s&&(this.currentZone=s,this.narrator.setPhrases(e.phrases),"game"==this.storyMode&&this.audio.play("UI_BoxAppear"))}))}}setupInput(){this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE).on("down",this.onTapDown,this).on("up",this.onTapUp,this),this.input.on("pointerdown",this.onTapDown,this),this.input.on("pointerup",this.onTapUp,this),this.keys=this.input.keyboard.addKeys({up:"up",down:"down",left:"left",right:"right",W:"W",S:"S",A:"A",D:"D"}),this.mouseInput=new Phaser.Math.Vector2(0,0)}get left(){return this.keys.left.isDown||this.keys.A.isDown}get right(){return this.keys.right.isDown||this.keys.D.isDown}get down(){return this.keys.down.isDown||this.keys.S.isDown}get up(){return this.keys.up.isDown||this.keys.W.isDown}getInputDirection(){return this.narrator.dragWord.drag?{x:0,y:0}:(this.mouseInput.length()<30?(this.mouseInput.reset(),this.mouseInput.x+=-1*this.left+1*this.right,this.mouseInput.y+=-1*this.up+1*this.down):this.mouseInput.scale(6/this.W),this.mouseInput.length()>1&&this.mouseInput.setLength(1),this.mouseInput)}onTapDown(t){}onTapUp(t){}}],plugins:{global:[{key:"rexRoundRectanglePlugin",plugin:W.Z,start:!0}]}};new Phaser.Game(v)}},s={};function i(t){var r=s[t];if(void 0!==r)return r.exports;var a=s[t]={exports:{}};return e[t].call(a.exports,a,a.exports,i),a.exports}i.m=e,t=[],i.O=(e,s,r,a)=>{if(!s){var h=1/0;for(d=0;d<t.length;d++){for(var[s,r,a]=t[d],o=!0,n=0;n<s.length;n++)(!1&a||h>=a)&&Object.keys(i.O).every((t=>i.O[t](s[n])))?s.splice(n--,1):(o=!1,a<h&&(h=a));o&&(t.splice(d--,1),e=r())}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[s,r,a]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var r,a,[h,o,n]=s,d=0;for(r in o)i.o(o,r)&&(i.m[r]=o[r]);if(n)var l=n(i);for(e&&e(s);d<h.length;d++)a=h[d],i.o(t,a)&&t[a]&&t[a][0](),t[h[d]]=0;return i.O(l)},s=self.webpackChunkCatGotYourTongue=self.webpackChunkCatGotYourTongue||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var r=i.O(void 0,[216],(()=>i(531)));r=i.O(r)})();